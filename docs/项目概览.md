# gint 项目概览

## 项目简介

gint 是一个基于 Gin 框架的**轻量级**增强库，专注于提供核心的 Web 开发功能。项目参考了 ginx 的设计理念，但采取了不同的定位：

### 与 ginx 的定位差异

**ginx** - 功能完整的企业级框架
- 完整的中间件生态（爬虫检测、活跃连接限制等）
- 多种 Session 实现（Memory、Redis、Mixin）
- 完善的测试覆盖
- 适合大型企业项目

**gint** - 轻量级核心库
- ✅ **核心功能精简** - 只保留最常用的功能，减少学习成本
- ✅ **string 类型 UserID** - 更灵活，支持 UUID、ObjectID 等多种格式
- ✅ **全中文注释** - 降低理解门槛，适合中文开发者
- ✅ **快速上手** - 简单直接，适合中小型项目和快速开发
- ✅ **易于扩展** - 清晰的接口设计，方便根据需求定制

## 核心特性

### 1. 优雅的 Handler 包装器

提供 W/B/S/BS 四种包装函数，让业务代码更简洁：

```go
// 传统 Gin 写法
func handler(c *gin.Context) {
    var req LoginReq
    if err := c.ShouldBind(&req); err != nil {
        c.JSON(400, gin.H{"error": err.Error()})
        return
    }
    // 业务逻辑...
    c.JSON(200, gin.H{"code": 0, "data": result})
}

// gint 写法
gint.B(func(ctx *gctx.Context, req LoginReq) (gint.Result, error) {
    // 业务逻辑...
    return gint.Result{Code: 0, Data: result}, nil
})
```

### 2. 完善的 Session 管理

JWT + Redis 混合存储方案：
- **JWT** - 存储轻量、不变的数据（用户ID、角色等）
- **Redis** - 存储完整、可变的会话数据
- **自动续期** - 支持会话自动刷新
- **多种载体** - 支持 Header 和 Cookie 两种 Token 传输方式

### 3. 统一的错误处理

内置错误处理机制，代码更简洁：
- 特殊错误（`ErrNoResponse`、`ErrUnauthorized`）有特殊处理逻辑
- 普通错误自动记录日志并返回 500
- 业务错误通过 `Result.Code` 返回

### 4. 实用的中间件

- **访问日志** - 记录请求和响应信息，支持自定义日志处理
- **限流器** - 支持 IP 限流、用户 ID 限流和自定义策略
- **CORS** - 处理跨域请求，支持灵活配置

### 5. 类型安全

使用 Go 1.21+ 泛型特性，提供类型安全的参数绑定：

```go
gint.B(func(ctx *gctx.Context, req LoginReq) (gint.Result, error) {
    // req 的类型在编译时就确定了，避免类型断言错误
})
```

### 6. 增强的 Context

`gctx.Context` 提供了更便捷的方法：
- 链式类型转换（`Param().IntOr(0)`）
- 用户 ID 管理（`UserId()`、`SetUserId()`）
- SSE 支持（`EventStream()`）
- 便捷响应（`Success()`、`Error()`）

## 项目结构

```
gint/
├── types.go                    # 核心类型定义（Result、PageData 等）
├── error.go                    # 错误定义
├── wrapper.go                  # Handler 包装器（W/B/S/BS）
│
├── gctx/                       # 增强的 Context
│   └── context.go
│
├── session/                    # Session 管理
│   ├── types.go                # 接口定义
│   ├── redis/                  # Redis 实现
│   ├── header/                 # Header Token 载体
│   └── cookie/                 # Cookie Token 载体
│
├── middlewares/                # 中间件
│   ├── accesslog/              # 访问日志
│   ├── ratelimit/              # 限流器
│   └── cors/                   # CORS
│
├── internal/                   # 内部工具（不对外暴露）
│   └── jwt/                    # JWT 管理
│
├── examples/                   # 示例代码
│   └── basic/
│
└── docs/                       # 文档
    ├── overview.md             # 项目概览（本文件）
    ├── handler-wrapper.md      # Handler 包装器详解
    ├── session.md              # Session 管理详解
    ├── middleware.md           # 中间件详解
    └── context.md              # Context 增强功能详解
```

## 技术栈

- **Go**: 1.21+（使用泛型特性）
- **Gin**: 1.9.1（Web 框架）
- **JWT**: golang-jwt/jwt/v5（Token 生成）
- **Redis**: go-redis/v9（Session 存储）
- **UUID**: google/uuid（Session ID 生成）

## 与 ginx 的功能对比

| 特性 | ginx | gint | 说明 |
|------|------|------|------|
| **定位** | 企业级框架 | 轻量级核心库 | gint 专注核心功能 |
| **UserID 类型** | `int64` | `string` | gint 更灵活 |
| **注释语言** | 英文 | 中文 | gint 降低理解门槛 |
| **Handler 包装器** | ✅ | ✅ | 核心功能相同 |
| **Session 管理** | ✅ 多种实现 | ✅ Redis + Memory | gint 提供常用实现 |
| **访问日志** | ✅ | ✅ | 核心功能相同 |
| **限流器** | ✅ | ✅ | 核心功能相同 |
| **活跃连接限制** | ✅ | ✅ | 核心功能相同 |
| **Memory Session** | ✅ | ✅ | 核心功能相同 |
| **CORS** | ❌ | ✅ | gint 补充了常用功能 |
| **爬虫检测** | ✅ | ❌ | 暂未实现 |
| **外部依赖** | ekit | 无 | gint 依赖更少 |
| **测试覆盖** | 完善 | 基础 | ginx 更适合企业级 |

### 如何选择？

**选择 ginx 如果你需要：**
- 完整的企业级功能
- 爬虫检测等高级中间件
- 完善的测试覆盖
- 更多的 Session 存储方案（Mixin 等）

**选择 gint 如果你需要：**
- 快速上手，简单直接
- 核心功能齐全（Handler、Session、中间件）
- 中文注释，易于理解
- 灵活的 UserID 类型（string）
- 轻量级，依赖少

## 快速开始

### 安装

```bash
go get github.com/ink-code/gint
```

### 最简示例

```go
package main

import (
    "github.com/gin-gonic/gin"
    "github.com/ink-code/gint"
    "github.com/ink-code/gint/gctx"
)

func main() {
    r := gin.Default()
    
    r.GET("/ping", gint.W(func(ctx *gctx.Context) (gint.Result, error) {
        return gint.Result{Code: 0, Msg: "pong"}, nil
    }))
    
    r.Run(":8080")
}
```

## 设计理念

### 1. 简洁优雅

通过 Handler 包装器，让业务代码专注于核心逻辑，自动处理参数绑定、错误处理、响应格式化等重复工作。

### 2. 类型安全

使用泛型提供编译时类型检查，避免运行时类型断言错误。

### 3. 灵活扩展

提供清晰的接口定义，方便实现自定义的 Session 存储、限流器、Token 载体等。

### 4. 开箱即用

提供常用的中间件和工具，减少重复造轮子。

## 适用场景

### gint 适合

- ✅ **中小型项目** - 快速开发，功能够用
- ✅ **个人项目** - 简单直接，易于理解
- ✅ **学习项目** - 中文注释，学习成本低
- ✅ **快速原型** - 核心功能齐全，快速验证想法
- ✅ **API 服务** - RESTful API 开发
- ✅ **需要灵活 UserID** - 使用 UUID、ObjectID 等

### gint 不太适合

- ❌ **大型企业项目** - 建议使用 ginx，功能更全面，测试覆盖更完善
- ❌ **需要爬虫检测** - ginx 提供了完整的爬虫检测功能
- ❌ **需要更多 Session 存储** - gint 提供 Redis 和 Memory，ginx 还支持 Mixin 等

## 下一步

- 查看 [Handler 包装器详解](./Handler包装器.md) 了解四种包装器的使用
- 查看 [Session 管理详解](./Session管理.md) 了解如何管理用户会话
- 查看 [中间件详解](./中间件.md) 了解如何使用内置中间件
- 查看 [Context 增强功能详解](./Context增强.md) 了解增强的 Context 功能

## 贡献

欢迎提交 Issue 和 Pull Request！

在提交 PR 前，请确保：
1. 代码通过 `go fmt` 格式化
2. 添加了必要的中文注释
3. 通过了所有测试
4. 更新了相关文档

## 许可证

MIT License
